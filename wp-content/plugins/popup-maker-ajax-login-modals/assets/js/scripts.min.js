!function(e){"use strict";function o(o,i){"function"!=typeof i&&(i=function(){}),e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:o,success:i})}e.fn.serializeObject=function(){var o={},i=this.serializeArray();return e.each(i,function(){void 0!==o[this.name]?(o[this.name].push||(o[this.name]=[o[this.name]]),o[this.name].push(this.value||"")):o[this.name]=this.value||""}),o};var i,r=e(),a=e(),n=e(),t=e(),s=e(),l=e();e(".popmake").on("popmakeInit",function(){var p=e(this),c=p.data("popmake"),d=c.meta.ajax_login,m=c.meta.ajax_registration,f=c.meta.ajax_recovery;void 0!==d&&d.enabled&&e("#ajax-login-form").length&&(r=e(".popmake-login-form"),t=e("form",r),t.attr("action").indexOf("/popup/")>-1&&t.attr("action",""),t.on("submit",function(i){var a=e("p.message",r),n=e.extend(t.serializeObject(),{action:"ajaxlogin",popup_id:c.id,login:!0,nonce:popmake_alm.nonce});i.preventDefault(),t.find("input.error").removeClass("error").next(".message.error").remove(),a.length||(e(".popmake-alm-footer-links",r).before('<p class="message notice"></p>'),a=e("p.message",r)),a.removeClass("error").removeClass("success").html(popmake_alm.I10n.login_loading_text).slideDown(),o(n,function(e){e.success===!0?(a.addClass("success").html(e.message),setTimeout(function(){a.slideUp(function(){p.on("popmakeBeforeClose",function(){null===d.disable_redirect&&(window.location.href=""!==d.redirect_url?d.redirect_url:window.location.href)}).popmake("close")})},5e3)):a.addClass("error").html(e.message)})})),void 0!==m&&m.enabled&&e(".popmake-registration-form form").length&&(a=e(".popmake-registration-form"),s=e("form",a),s.attr("action").indexOf("/popup/")>-1&&s.attr("action",""),i=function(r){var n,t=e("p.message",a),l=e.extend(s.serializeObject(),{action:"ajaxlogin",popup_id:c.id,register:!0,nonce:popmake_alm.nonce});return r.preventDefault(),s.find("input.error").removeClass("error").next(".message.error").remove(),t.length||(e(".popmake-alm-footer-links",a).before('<p class="message notice"></p>'),t=e("p.message",a)),t.removeClass("error").removeClass("success").html(popmake_alm.I10n.registration_loading_text).slideDown(),e("#ajax_registration_pass",s).length&&e("#ajax_registration_pass",s).val()!==e("#ajax_registration_confirm",s).val()?void t.addClass("error").html("Passwords don't match."):void o(l,function(o){o.success===!0?void 0!==o.form?(s.replaceWith(o.form),s=e("form",a)):void 0!==o.message?(t.addClass("success").html(o.message),setTimeout(function(){t.slideUp(function(){p.on("popmakeBeforeClose",function(){null===m.disable_redirect&&(window.location.href=""!==m.redirect_url?m.redirect_url:window.location.href)}).popmake("close")})},5e3)):null===m.disable_redirect&&(window.location.href=""!==m.redirect_url?m.redirect_url:window.location.href):(t.addClass("error").html(o.message),void 0!==o.field?(n=e('[name="'+o.field+'"]',s)||null,n.length&&e("html, body").animate({scrollTop:n.offset().top-100},1e3,function(){n.addClass("error").focus(),t.insertAfter(n)})):void 0!==o.form&&(s.replaceWith(o.form),s=e("form",a),t.slideUp(),s.on("submit",i),n=e(".error, .wppb-field-error",s).eq(0),e("html, body").animate({scrollTop:n.offset().top-100},1e3,function(){n.addClass("error").focus()})))})},s.on("submit",i)),void 0!==f&&e("#ajax-recovery-form").length&&(n=e(".popmake-recovery-form"),l=e("form",n),l.attr("action").indexOf("/popup/")>-1&&l.attr("action",""),l.on("submit",function(i){var r=e("p.message",n),a=e.extend(l.serializeObject(),{action:"ajaxlogin",popup_id:c.id,recovery:!0,nonce:popmake_alm.nonce});i.preventDefault(),t.find("input.error").removeClass("error").next(".message.error").remove(),r.length||(e(".popmake-alm-footer-links",n).before('<p class="message notice"></p>'),r=e("p.message",n)),r.removeClass("error").removeClass("success").html(popmake_alm.I10n.recovery_loading_text).slideDown(),o(a,function(e){e.success===!0?(r.addClass("success").html(e.message),setTimeout(function(){r.slideUp(function(){p.on("popmakeBeforeClose",function(){null===f.disable_redirect&&(window.location.href=""!==f.redirect_url?f.redirect_url:window.location.href)}).popmake("close")})},2e3)):r.addClass("error").html(e.message)})})),void 0!==d&&e("#ajax-login-form").length&&d.force_login&&(jQuery.fn.popmake.last_open_trigger="Force Login Popup ID-"+c.id,r.show(),a.hide(),n.hide(),p.on("popmakeSetupClose",function(){var o=e("> ."+c.close.attr["class"],p);o.hide().off("click.popmake")}).popmake("open")),(void 0!==d||void 0!==m||void 0!==f)&&p.on("popmakeBeforeOpen",function(){var o=e(e.fn.popmake.last_open_trigger),i=null;o.length&&((o.hasClass("popswitch-registration")||o.find(".popswitch-registration").length)&&(r.hide(),a.show(),n.hide(),i=!0),(o.hasClass("popswitch-recovery")||o.find(".popswitch-recovery").length)&&(r.hide(),a.hide(),n.show(),i=!0),(o.hasClass("popswitch-login")||o.find(".popswitch-login").length||null===i)&&(r.show(),a.hide(),n.hide()))}),e(".popmake-"+c.id+".popswitch-login",p).off("click").on("click",function(e){e.preventDefault(),e.stopPropagation(),a.slideUp(),n.slideUp(),r.appendTo(r.parent()).slideDown()}),e(".popmake-"+c.id+".popswitch-registration",p).off("click").on("click",function(e){e.preventDefault(),e.stopPropagation(),r.slideUp(),n.slideUp(),a.appendTo(a.parent()).slideDown()}),e(".popmake-"+c.id+".popswitch-recovery",p).off("click").on("click",function(e){e.preventDefault(),e.stopPropagation(),r.slideUp(),a.slideUp(),n.appendTo(n.parent()).slideDown()})})}(jQuery);